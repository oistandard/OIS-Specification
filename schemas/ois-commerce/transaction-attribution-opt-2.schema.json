{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://ois.foundation/schemas/ois-commerce/transaction-attribution-opt-2.schema.json",
  "title": "OIS Commerce Transaction Attribution (Option 2)",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "eventType",
    "storeId",
    "screenId",
    "mediaId",
    "product",
    "interaction",
    "transaction",
    "confidence"
  ],
  "properties": {
    "eventType": { "type": "string", "enum": ["commerce-attribution"] },
    "storeId": { "type": "string" },
    "screenId": { "type": "string" },
    "mediaId": { "type": "string" },
    "product": {
      "type": "object",
      "additionalProperties": false,
      "required": ["sku", "name"],
      "properties": {
        "sku": { "type": "string" },
        "name": { "type": "string" }
      }
    },
    "interaction": {
      "type": "object",
      "additionalProperties": false,
      "required": ["type", "dwellSeconds"],
      "properties": {
        "type": { "type": "string", "enum": ["viewed", "touched", "engaged"] },
        "dwellSeconds": { "type": "number", "minimum": 0 }
      }
    },
    "transaction": {
      "type": "object",
      "additionalProperties": false,
      "required": ["posSystem", "transactionId", "occurredAt"],
      "properties": {
        "posSystem": { "type": "string" },
        "transactionId": { "type": "string" },
        "occurredAt": { "type": "string", "format": "date-time" }
      }
    },
    "confidence": { "type": "number", "minimum": 0, "maximum": 1 }
  }
}
